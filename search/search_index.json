{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to Chris Titus WinUtil Official Documentation!","text":""},{"location":"#running","title":"Running","text":"<p>There are 4 ways to run WinUtil. The 4 ways goes as follows:</p> <ul> <li><code>irm christitus.com/win | iex</code> - Runs WinUtil from ChrisTitus's website using the latest Full Releases.</li> <li><code>irm https://github.com/ChrisTitusTech/winutil/releases/latest/download/winutil.ps1 | iex</code> - Runs WinUtil from github using the latest Full Release.</li> <li><code>irm christitus.com/windev | iex</code> - Runs WinUtil from ChrisTitus website using the latest Pre-Release.</li> <li><code>irm https://github.com/ChrisTitusTech/winutil/releases/latest/download/windev.ps1 | iex</code> - Runs WinUtil from github using the latest Pre-Release.</li> </ul>"},{"location":"KnownIssues/","title":"Known Issues","text":""},{"location":"KnownIssues/#known-issues-and-fixes","title":"Known Issues and Fixes","text":""},{"location":"KnownIssues/#launch-issues","title":"Launch Issues:","text":"<ul> <li>Windows Security (formerly Defender) and other anti-virus software are known to block the script. The script gets flagged due to the fact that it requires administrator privileges &amp; makes drastic system changes.</li> <li> <p>If possible: Allow script in Anti-Virus software settings.</p> </li> <li> <p>If you are having TLS 1.2 issues, or are having trouble resolving <code>christitus.com/win</code> then run with the following command:</p> </li> </ul> <pre><code>[Net.ServicePointManager]::SecurityProtocol=[Net.SecurityProtocolType]::Tls12;iex(New-Object Net.WebClient).DownloadString('https://github.com/ChrisTitusTech/winutil/releases/latest/download/winutil.ps1')\n</code></pre> <ul> <li>If you are unable to resolve <code>christitus.com/win</code> and are getting  errors launching the tool, it might be due to India blocking GitHub's content domain and preventing downloads.</li> <li>Source: https://timesofindia.indiatimes.com/gadgets-news/github-content-domain-blocked-for-these-indian-users-reports/articleshow/96687992.cms</li> </ul> <p>If you are still having issues try using a VPN, or changing your DNS provider to:</p> <code>1.1.1.1</code> <code>1.0.0.1</code> or <code>8.8.8.8</code> <code>8.8.4.4</code> <ul> <li>Script doesn't run/PowerShell crashes:</li> <li>Press Windows Key+X and select 'PowerShell (Admin)' (Windows 10) or 'Windows Terminal (Admin)' (Windows 11)</li> <li>Run:   <code>ps1   Set-ExecutionPolicy Unrestricted -Scope Process -Force</code></li> <li>Run:   <code>ps1   irm christitus.com/win | iex</code></li> </ul>"},{"location":"KnownIssues/#other-issues","title":"Other Issues:","text":"<ul> <li>Windows taking longer to shut down:</li> <li>#69 Turn on fast startup: Press Windows key + R, then type:   <code>control /name Microsoft.PowerOptions /page pageGlobalSettings</code></li> <li>If that doesn't work, Disable Hibernation: Press Windows Key+X and select 'PowerShell (Admin)' (Windows 10) or 'Windows Terminal (Admin)' (Windows 11) and enter:   <code>ps1   powercfg /H off</code></li> <li>#69 95 #232 Windows Search does not work: Enable Background Apps</li> <li>#198 Xbox Game Bar Activation Broken: Set the Xbox Accessory Management Service to Automatic</li> </ul> <pre><code>Get-Service -Name \"XboxGipSvc\" | Set-Service -StartupType Automatic\n</code></pre> <ul> <li>Winget requires interaction on first run: Manually type 'y' and 'enter' into the PowerShell console to continue</li> <li> <p>(Windows 11) Quick Settings no longer works: Launch the Script and click 'Enable Action Center'</p> </li> <li> <p>Explorer no longer launches: Go to Control Panel, File Explorer Options, Change the 'Open File Explorer to' option to 'This PC'.</p> </li> </ul>"},{"location":"KnownIssues/#battery-drains-too-fast","title":"Battery drains too fast.","text":"<p>When your battery on the laptop drains too fast, please perform these steps and report the results back to the Winutil community.</p> <ol> <li>Check Battery Health:</li> <li>Open a Command Prompt as an administrator.</li> <li>Run the following command to generate a battery report:      <code>powershell      powercfg /batteryreport /output \"C:\\battery_report.html\"</code></li> <li> <p>Open the generated HTML report to review information about battery health and usage.</p> </li> <li> <p>Review Power Settings:</p> </li> <li>Go to \"Settings\" &gt; \"System\" &gt; \"Power &amp; sleep.\"</li> <li>Adjust power plan settings based on your preferences and usage patterns.</li> <li> <p>Click on \"Additional power settings\" to access advanced power settings.</p> </li> <li> <p>Identify Power-Hungry Apps:</p> </li> <li>Right-click on the taskbar and select \"Task Manager.\"</li> <li>Navigate to the \"Processes\" tab to identify applications with high CPU or memory usage.</li> <li> <p>Consider closing unnecessary background applications.</p> </li> <li> <p>Update Drivers:</p> </li> <li>Visit your laptop manufacturer's website or use Windows Update to check for driver updates.</li> <li> <p>Ensure graphics, chipset, and other essential drivers are up to date.</p> </li> <li> <p>Check for Windows Updates:</p> </li> <li>Go to \"Settings\" &gt; \"Update &amp; Security\" &gt; \"Windows Update.\"</li> <li> <p>Check for and install any available updates for your operating system.</p> </li> <li> <p>Reduce Screen Brightness:</p> </li> <li>Adjust screen brightness based on your preferences and lighting conditions.</li> <li> <p>Go to \"Settings\" &gt; \"System\" &gt; \"Display\" to adjust brightness.</p> </li> <li> <p>Battery Saver Mode:</p> </li> <li>Go to \"Settings\" &gt; \"System\" &gt; \"Battery.\"</li> <li> <p>Turn on \"Battery saver\" to limit background activity and conserve power.</p> </li> <li> <p>Check Power Usage in Settings:</p> </li> <li>Go to \"Settings\" &gt; \"System\" &gt; \"Battery\" &gt; \"Battery usage by app.\"</li> <li> <p>Review the list of apps and their power usage.</p> </li> <li> <p>Check Background Apps:</p> </li> <li>Go to \"Settings\" &gt; \"Privacy\" &gt; \"Background apps.\"</li> <li> <p>Disable unnecessary apps running in the background.</p> </li> <li> <p>Use Powercfg for Analysis:</p> <ul> <li>Open a Command Prompt as an administrator.</li> <li>Run the following command to analyze energy usage and generate a report:   <code>powershell   powercfg /energy /output \"C:\\energy_report.html\"</code></li> <li>Open the generated HTML report to identify energy consumption patterns.</li> </ul> </li> <li> <p>Review Event Viewer:</p> <ul> <li>Open Event Viewer by searching for it in the Start menu.</li> <li>Navigate to \"Windows Logs\" &gt; \"System.\"</li> <li>Look for events with the source \"Power-Troubleshooter\" to identify power-related events.</li> </ul> </li> <li> <p>Check Wake-up Sources:</p> <ul> <li>Open a Command Prompt as an administrator.</li> <li>Use the command <code>powercfg /requests</code> to identify processes preventing sleep.</li> <li>Check Task Scheduler for tasks waking up the computer.</li> <li>Use the command <code>powercfg /waketimers</code> to view active wake timers.</li> </ul> </li> <li> <p>Resource Monitor:</p> <ul> <li>Open Resource Monitor from the Start menu.</li> <li>Navigate to the \"CPU\" tab and identify processes with high CPU usage.</li> </ul> </li> <li> <p>Windows Settings - Activity History:</p> <ul> <li>In \"Settings,\" go to \"Privacy\" &gt; \"Activity history.\"</li> <li>Turn off \"Let Windows collect my activities from this PC.\"</li> </ul> </li> <li> <p>Network Adapters:</p> <ul> <li>Open Device Manager by searching for it in the Start menu.</li> <li>Locate your network adapter, right-click, and go to \"Properties.\"</li> <li>Under the \"Power Management\" tab, uncheck the option that allows the device to wake the computer.</li> </ul> </li> <li> <p>Review Installed Applications:</p> <ul> <li>Manually review installed applications by searching for \"Add or remove programs\" in the Start menu.</li> <li>Check settings/preferences of individual applications for power-related options.</li> <li>Uninstall unnecessary or problematic software.</li> </ul> </li> </ol> <p>By following these detailed instructions, you should be able to thoroughly diagnose and address battery drain issues on your Windows laptop. Adjust settings as needed to optimize power management and improve battery life.</p>"},{"location":"KnownIssues/#troubleshoot-errors-during-microwin-usage","title":"Troubleshoot errors during Microwin usage","text":""},{"location":"KnownIssues/#error-0x80041031","title":"Error <code>0x80041031</code>","text":"<p>This error code typically indicates an issue related to Windows Management Instrumentation (WMI). Here are a few steps you can try to resolve the issue:</p> <ol> <li> <p>Reboot Your Computer:    Sometimes, a simple reboot can resolve temporary issues. Restart your computer and try mounting the ISO again.</p> </li> <li> <p>Check for System Corruption:    Run the System File Checker (SFC) utility to scan and repair system files that may be corrupted.    <code>powershell    sfc /scannow</code></p> </li> <li> <p>Update Your System:    Make sure your operating system is up-to-date. Check for Windows updates and install any pending updates.</p> </li> <li> <p>Check WMI Service:    Ensure that the Windows Management Instrumentation (WMI) service is running. You can do this through the Services application:</p> </li> <li>Press <code>Win + R</code> to open the Run dialog.</li> <li>Type <code>services.msc</code> and press Enter.</li> <li>Locate \"Windows Management Instrumentation\" in the list.</li> <li> <p>Make sure to set its status to \"Running\" and the startup type to \"Automatic.\"</p> </li> <li> <p>Check for Security Software Interference:    Security software can sometimes interfere with WMI operations. Temporarily disable your antivirus or security software and check if the issue persists.</p> </li> <li> <p>Event Viewer:    Check the Event Viewer for more detailed error information. Look for entries related to the <code>80041031</code> error and check if there are any additional details that can help identify the cause.</p> </li> <li> <p>Press <code>Win + X</code> and select \"Event Viewer.\"</p> </li> <li>Navigate to \"Windows Logs\" -&gt; \"Application\" or \"System.\"</li> <li> <p>Look for entries with the source related to WMI or the application use to mount the ISO.</p> </li> <li> <p>ISO File Integrity:    Ensure that the ISO file you are trying to mount is uncorrupted. Try mounting a different ISO file to see if the issue persists.</p> </li> </ol> <p>If the problem persists after trying these steps, additional troubleshooting is required. Consider seeking assistance from Microsoft support or community forums for more specific guidance based on your system configuration and the software you use to mount the ISO.</p>"},{"location":"contribute/","title":"How to Contribute?","text":""},{"location":"contribute/#issues","title":"Issues","text":"<ul> <li>If you encounter any challenges or problems with the script, I kindly request that you submit them via the \"Issues\" tab on the GitHub repository. By filling out the provided template, you can provide specific details about the issue, allowing me (and others in the community) to promptly address any bugs, or consider feature requests.</li> </ul>"},{"location":"contribute/#contribute-code","title":"Contribute Code","text":"<ul> <li> <p>Pull Requests are now handled directly on the MAIN branch. This was done since we can now select specific releases to launch via releases in GitHub.</p> </li> <li> <p>If you're doing code changes, then you can submit a PR to <code>main</code> branch, but I am very selective about these.</p> </li> </ul> <p>[!WARNING] Do not use a code formatter, massive amounts of line changes, and make multiple feature changes. EACH FEATURE CHANGE SHOULD BE IT'S OWN Pull Request!</p> <ul> <li> <p>When creating pull requests, it is essential to thoroughly document all changes made. This includes, but not limited to, documenting any additions made to the <code>tweaks</code> section and corresponding <code>undo tweak</code>, so users are able to remove the newly added tweaks if necessary, and comprehensive documentation is required for all code changes, document your changes and briefly explain why you made your changes in your Pull Request Description. Failure to adhere to this format may result in denial of the pull request. Additionally, Any code lacking sufficient documentation may also be denied.</p> </li> <li> <p>By following these guidelines, we can maintain a high standard of quality and ensure that the codebase remains organized and well-documented.</p> </li> </ul> <p>[!NOTE] When creating a function, please include \"WPF\" or \"WinUtil\" in the file name so it can be loaded into the runspace.</p>"},{"location":"contribute/#walk-through","title":"Walk through","text":""},{"location":"contribute/#fork-the-repo","title":"Fork the Repo","text":"<ul> <li>Fork the WinUtil Repository here to create a copy that will be available in your Repository-list. </li> </ul>"},{"location":"contribute/#clone-the-fork","title":"Clone the Fork","text":"<ul> <li>While you can make your changes directly through the Web, we recommend cloning the repo to your device to test your fork easily.</li> <li>Using the application GitHub Desktop (available in WinUtil) you can easily manage your repos locally. You can do it using other tools like git-cli (available in WinUtil), we recommend GitHub Desktop for ease of use.</li> <li>Install GitHub Desktop if not already installed</li> <li>Log in using the same GitHub account u used to fork WinUtil</li> <li>Choose the fork under \"Your Repositories\" and press \"clone {repo name}\"</li> <li> <p>Create a new Branch and name it something relatable to your changes,</p> </li> <li> <p>Now you can modify WinUtil to your liking using your prefered text editor.</p> </li> </ul>"},{"location":"contribute/#testing-your-changes","title":"Testing your changes","text":"<ul> <li> <p>To test to see if your changes work as intended run following commands in a powershell teminal:</p> </li> <li> <p>Change the directory where you are running the commands to the forked project.</p> </li> <li><code>cd {path to the folder with the compile.ps1}</code></li> <li>Run following command to compile and run Winutil</li> <li><code>.\\Compile.ps1 -run</code></li> <li>After seeing that your changes work properly feel free to commit the changes to the repository and make a PR, for help on that follow the documentation below.</li> </ul>"},{"location":"contribute/#commiting-the-changes","title":"Commiting the changes","text":"<ul> <li>Commit your changes once you are fine with the result</li> <li>Push the changes to \"upload\" them to your fork on github.com.</li> </ul>"},{"location":"contribute/#making-a-pr","title":"Making a PR","text":"<ul> <li>To make a PR on your repo under a new branch linking to the main branch a button will show and say Preview and Create pull request. Click that button and fill in all information that is provided on the template. Once all the information is filled in correctly check your PR to make sure there is not a WinUtil.ps1 file attached to the PR. Once everything is good make the PR and wait for Chris (The Maintainer) to accept or deny your PR. Once it is accepted in by Chris you will be able to see your changes in the /windev build.</li> <li>If you do not see your feature in the main /win build that is fine. As all new changes go into the /windev build to make sure everything is working ok before going fully public.</li> <li>Congrats you just submitted your first PR. Thank you so much for contributing to WinUtil.</li> </ul>"},{"location":"faq/","title":"FAQ's","text":""},{"location":"faq/#how-do-i-uninstall-winutil","title":"How do I uninstall WinUtil?","text":"<ul> <li>You do not have to uninstall WinUtil. As it is a script you run from Powershell it only loads into your RAM. This means as soon as you close WinUtil it will be deleted off your system.</li> </ul>"},{"location":"updates/","title":"Update Log","text":""},{"location":"updates/#_1","title":"Updates","text":""},{"location":"userguide/","title":"User Guide","text":""},{"location":"userguide/#overview","title":"Overview","text":"<ul> <li>short one</li> </ul>"},{"location":"userguide/#walkthrough","title":"Walkthrough","text":""},{"location":"userguide/#program","title":"Program","text":""},{"location":"userguide/#installation-updates","title":"Installation &amp; Updates","text":"<ul> <li>To install programs select the programs you wish to install or update like the picture below. </li> <li>Once you have selected the programs you wish to install click the select Install/Upgrade Selected button as seen below. </li> </ul>"},{"location":"userguide/#upgrade-all","title":"Upgrade All","text":"<ul> <li>Press the button to upgrade all installed programs that are supported by WinGet, there is no selection needed.</li> </ul>"},{"location":"userguide/#uninstall","title":"Uninstall","text":"<ul> <li>To uninstall programs select the programs you wish to uninstall like the picture below. </li> <li>Once you have selected the programs you wish to uninstall click the select Uninstall Selected button as seen below. </li> </ul>"},{"location":"userguide/#get-installed","title":"Get Installed","text":"<ul> <li>Checks for installed programs that are supported by WinGet and selects them in the Utility.</li> </ul>"},{"location":"userguide/#clear-selection","title":"Clear Selection","text":"<ul> <li>Clears ur current selection so no program is checked.</li> </ul>"},{"location":"userguide/#tweaks","title":"Tweaks","text":""},{"location":"userguide/#tweaks-addition","title":"Tweaks Addition","text":"<ul> <li>To enable tweaks on your system select Tweaks at the top next to Install.</li> <li>Then you can select what tweaks you want adding to your system. We do have some presets you can select from at the top you can see this in the picture below. </li> <li>After you have chosen your tweaks click the Run Tweaks button at the bottom of the screen.</li> </ul>"},{"location":"userguide/#tweaks-removal","title":"Tweaks Removal","text":"<ul> <li>To disable tweaks on your system select Tweaks at the top next to Install.</li> <li>Then you can select what tweaks you want removing from your system.</li> <li>After you have chosen your tweaks you want to remove click the Undo Selected Tweaks button at the bottom of the screen.</li> </ul>"},{"location":"userguide/#essential-tweaks","title":"Essential Tweaks","text":"<ul> <li>The Tweaks under the Essential</li> </ul>"},{"location":"userguide/#advanced-tweaks-caution","title":"Advanced Tweaks - CAUTION","text":""},{"location":"userguide/#oo-shutup","title":"O&amp;O Shutup","text":""},{"location":"userguide/#dns","title":"DNS","text":""},{"location":"userguide/#customize-preferences","title":"Customize Preferences","text":""},{"location":"userguide/#performance-plans","title":"Performance Plans","text":""},{"location":"userguide/#shortcuts","title":"Shortcuts","text":""},{"location":"userguide/#config","title":"Config","text":""},{"location":"userguide/#features","title":"Features","text":"<ul> <li>Install the most used Windows Features by checking the checkbox and clicking \"Install Features\" to install them</li> </ul>"},{"location":"userguide/#fixes","title":"Fixes","text":"<ul> <li> <p>Quick Fixes for your system if you are having Issues.</p> </li> <li> <p>Set Up Autologin</p> </li> <li>Reset Windows Update</li> <li>Reset Network</li> <li>System Corruption Scan</li> <li>WinGet Reinstall</li> <li>Remove Adobe Creative Cloud</li> </ul>"},{"location":"userguide/#legacy-windows-panels","title":"Legacy Windows Panels","text":""},{"location":"userguide/#updates-not-working-rn","title":"Updates | Not working rn","text":""},{"location":"userguide/#microwin","title":"MicroWin","text":"<p>MicroWin lets you customize your Windows 10 and 11 installation images by debloating them however you want.</p> <p></p>"},{"location":"userguide/#basic-usage","title":"Basic usage","text":"<ol> <li> <p>Specify the source Windows ISO to customize</p> <ul> <li>If you don't have a Windows ISO file prepared, you can download it using the Media Creation Tool for the respective Windows version. Here is the Windows 11 version, and here is the Windows 10 version</li> </ul> </li> <li> <p>Configure the debloat process</p> </li> <li>Specify the target location for the new ISO file</li> <li>Let the magic happen!</li> </ol> <p>NOTE: this feature is still in development and you may encounter some issues with the generated images. If that happens, don't hesitate to report an issue!</p>"},{"location":"userguide/#options","title":"Options","text":"<ul> <li> <p>Download oscdimg.exe from CTT GitHub repo will grab a OSCDIMG executable from the GitHub repository instead of a Chocolatey package</p> <p>OSCDIMG is the tool that lets the program create ISO images. Typically, you would find this in the Windows Assessment and Deployment Kit</p> </li> <li> <p>Selecting a scratch directory will copy the contents of the ISO file to the directory you specify instead of an automatically generated folder on the <code>%TEMP%</code> directory</p> </li> <li> <p>You can select an edition of Windows to debloat (SKU) using the convenient drop-down menu</p> <p>By default, MicroWin will debloat the Pro edition, but you can choose any edition you want</p> </li> </ul>"},{"location":"userguide/#customization-options","title":"Customization options","text":"<ul> <li> <p>Keep Provisioned Packages: leaving this option unticked (default) will try to remove every operating system package</p> <p>Some packages may remain after processing. This can happen if the packages in question were permanent ones or had been superseded by newer versions</p> </li> <li> <p>Keep Appx Packages: leaving this option unticked (default) will try to remove every Microsoft Store app from the Windows image</p> <p>This option will exclude some applications that are essential in the case that you want or need to add a Store app later on</p> </li> <li> <p>Keep Defender: leaving this option unticked will try to remove every part of Windows Defender, including the Windows Security app</p> <p>Leaving this option unticked is NOT recommended unless you plan to use a third-party antivirus solution on your MicroWin installation. On that regard, don't install AVs with bad reputation or rogueware</p> </li> <li> <p>Keep Edge: leaving this option unticked will try to remove every part of the Microsoft Edge browser using the best methods available</p> <p>Leaving this option unticked is not recommended because it might break some applications that might depend on the <code>Edge WebView2</code> runtime. However, if that happens, you can easily reinstall it</p> </li> </ul>"},{"location":"userguide/#driver-integration-options","title":"Driver integration options","text":"<ul> <li>Inject drivers will add the drivers in the folder that you specify to the target Windows image</li> <li> <p>Import drivers from current system will add every third-party driver that is present in your active installation</p> <p>This makes the target image have the same hardware compatibility of the active installation. However, this means that you will only be able to install the target Windows image and take full advantage of it on computers with the same hardware. To avoid this, you'll need to customize the <code>install.wim</code> file of the target ISO in the <code>sources</code> folder</p> </li> </ul>"},{"location":"userguide/#ventoy-options","title":"Ventoy options","text":"<ul> <li> <p>Copy to Ventoy will copy the target ISO file to any USB drive with Ventoy installed</p> <p>Ventoy is a solution that lets you boot to any ISO file stored in a drive. Think of it as having multiple bootable USBs in one. Do note though that your drive needs to have enough free space for the target ISO file</p> </li> </ul>"},{"location":"userguide/#automation","title":"Automation","text":"<ul> <li> <p>Some features are available through automation. This allows you to save your config file pass it to Winutil walk away and come back to a finished system. Here is how you can set it up currently with Winutil &gt;24.01.15</p> </li> <li> <p>On the Install Tab, click \"Get Installed\", this will get all installed apps supported by Winutil on the system </p> </li> <li>Click on the Settings cog in the upper right corner and chose Export, chose file file and location, this will export the setting file. </li> <li>Copy this file to a USB or somewhere you can use after Windows installation.</li> <li>Use Microwin tab to create a custom Windows image.</li> <li>Install the Windows image.</li> <li>In the new Windows, Open PowerShell in the admin mode and run command to automatically apply tweaks and install apps from the config file.</li> <li><code>iex \"&amp; { $(irm christitus.com/win) } -Config [path-to-your-config] -Run\"</code></li> <li>Have a cup of coffee! Come back when it's done.</li> </ul>"}]}